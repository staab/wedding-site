<html>
<head>
    <title>Jon and Valari</title>
    <script type="text/javascript" src="/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $('#intro a').on('click', function(){
                $('#intro').hide();
                $('#form').show();
            });
            var showDetails = function(){
                $('#form').hide();
                $('#epilogue').show();
                $('#submit').addClass('inactive')
                    .attr('disabled', true)
                    .find('span').text('Thanks!')
                    .off();

                // Gotta add this only when the element is visible.
                $('#map').html('<iframe src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d175518.93794382026!2d-117.18853379957393!3d46.57768026587551!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x54a02cdf14c5c589%3A0x96f103b312296840!2s501+Wawawai+Rd%2C+Colton%2C+WA+99113!5e0!3m2!1sen!2sus!4v1427808623778" width="245" height="200" frameborder="0" style="border:0;"></iframe>');
            };
            $("#skip").on("click", showDetails);
            $('#submit').on('click', function(){
                var $this = $(this),
                    name = $('#guest_name').val(),
                    email = $('#guest_email').val(),
                    number = $('#guest_number').val();

                $('#error').hide();
                if(!name){
                    $('#error').show().text('Please enter your name!');
                    return false;
                }
                if(email.indexOf('@') < 3){
                    $('#error').show().text("Please enter a valid email!");
                    return false;
                }

                $.ajax({
                    url: '/register/',
                    data: {
                        name: name,
                        email: email,
                        number: number,
                        coming: $("#guest_coming").prop('checked'),
                        message: $("#guest_message").val()
                    },
                    success: showDetails,
                    error: function(res){
                        $('#error').show().text("Something went wrong with your registration. Sorry about that!");
                    }
                })
            });
            $('body').on('keydown', function(e){
                if(e.keyCode === 13 && $('#form').css('display') == 'block'){
                    $('#submit').trigger('click');
                }
            });
            $('#guest_coming').click(function(){
                $('.guest-number').toggle()
                $('select.guest-number').val(0)
            });
            $("#leave_message").click(function(){
                $("#guest_message").val("").toggle()
            });
        });
    </script>
    <link rel="stylesheet" type="text/css" href="/css/reset.css">
    <link rel="stylesheet" type="text/css" href="/css/base.css">
    <style type="text/css">
    body {
        zoom: 1.6;
        text-shadow: 1px 1px #ccc;
    }

    p {
        margin: 10px;
        font-size: 12px;
        text-align: center;
    }

    #intro {

    }

    #form {
        display: none;
    }

    #form input, #form label {
        display: inline-block;
        width: 125px;
        border-radius: 3px;
    }
    #form label {
        position: relative;
        padding: 5px 4px;
        margin: 5px 8px 5px 0px;
        background: white; /*#3CD1FF;*/
    }
    #form label:hover {
        background: #eee; /*#FF9010;*/
    }
    #form .label-shadow {
        width: 129px;
        display: inline-block;
        background: #aaa; /*#0089B2;*/
        height: 25px;
        position: relative;
        margin: 0 20px -25px 2px;
        top: 8px;
        border-radius: 3px;
        box-shadow: 0 0 1px 1px #aaa; /*#0089B2;*/
    }
    #form .full-width {
        width:  261px;
    }
    #form .label-shadow.full-width {
        width:  265px;
    }
    #form textarea.full-width {
        width:  270px;
    }
    #leave_message {
        cursor: pointer;
    }
    #leave_message:active {
        top: 3px;
    }
    #guest_message {
        display: none;
    }
    #form input, #form select {
        margin-right: -20px;
        height: 27px;
        position: relative;
        padding: 4px;
        font-size: 16px;
        border: 0px;
    }
    #form input:focus, #form select:focus {
        box-shadow: 0 0 3px 3px #ccc inset;
    }
    #form input[type='checkbox']:focus {
        box-shadow: none;
    }

    #form input[type='checkbox'] {
        margin: -3px -20px 0 0;
        width: 27px;
        top: 8px;
        height: 27px;
    }

    #epilogue {
        display: none;
    }

    iframe {
        zoom: 1;
    }

    #more {
        text-align: center;
        margin: 20px;
    }

    #content {
        padding: 20px;
        margin: 0 -8px 0 0;
        position: relative;
        top: -2px;
        left: -4px;
        background: #ddd; /*#FFC284;*/
        box-shadow: 0 0 1px 1px black; /*#0089B2;*/
        border-radius: 25px;
    }

    #shadow {
        margin: 100px auto;
        width: 300px;
        position: relative;
        background: #aaa; /*#0089B2;*/
        box-shadow: 0 0 2px 2px #aaa; /*#0089B2;*/
        border-radius: 20px;
    }
    </style>
</head>
<body>
    <div id="wrapper">
        <div id="shadow">
            <div id="content">
                <div id="intro">
                    <h2>Welcome!</h2>
                    <a class="button">
                        <div class="body">
                            Rsvp...
                        </div>
                    </a>
                </div>
                <form id="form" action="#">
                    <h2>RSVP?</h2>
                    <p>Join us June 6, 2015 in Moscow, ID!</p>
                    <div id="error">
                        Nothin'
                    </div>
                    <div class="label-shadow"></div>
                    <label for="guest_name">Name: </label>
                    <input type="text" id="guest_name"></input>

                    <div class="label-shadow"></div>
                    <label for="guest_email">Email: </label>
                    <input type="text" id="guest_email"></input>

                    <div class="label-shadow"></div>
                    <label for="guest_coming">Coming?</label>
                    <input type="checkbox" id="guest_coming" checked="checked"></input>

                    <div class="label-shadow guest-number"></div>
                    <label for="guest_number" class='guest-number'>Guests: </label>
                    <select id="guest_number" class="guest-number">
                        <option value="0">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                    </select>

                    <div class="label-shadow full-width"></div>
                    <label for="guest_message" class="full-width" id="leave_message">Want to leave a message?</label>
                    <textarea rows="8" id="guest_message" class="full-width"></textarea>

                    <a class="button" id="submit">
                        <div class="body">
                            <span>Let us know!</span>
                        </div>
                    </a>
                    <a id="skip" style="font-size: 10px;">Already registered?</a>
                </form>
                <div id="epilogue">
                    <h2>Thanks!</h2>
                    <h3>Stuff you might want to know now...</h3>
                    <ol>
                        <li>
                            <h4>Ceremony location:</h4>
                            <small>
                                <a href="http://www.red-barn-farms.com/index.html" target="_blank">
                                    Red Barn Farms
                                </a>
                            </small>
                            <div id="map" style="zoom: 1"></div>
                        </li>
                        <li class="list-shadow"></li>
                        <li>
                            <h4>Registry providers:</h4>
                            <ul>
                            </ul>
                        </li>
                        <li class="list-shadow"></li>
                    </ol>
                    <div id="more">
                        <a href="/slideshow/">
                            More &rtrif;
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
